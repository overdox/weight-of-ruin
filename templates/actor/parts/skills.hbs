<section class="skills-section">
  <div class="section-header">
    <h3>{{localize "AOA.Section.Skills"}}</h3>
    <div class="skill-visibility-toggle">
      <label class="toggle-label" title="{{localize 'AOA.Skills.ShowAllHint'}}">
        <input type="checkbox" class="show-all-skills" {{#if showAllSkills}}checked{{/if}} />
        <span>{{localize "AOA.Skills.ShowAll"}}</span>
      </label>
    </div>
  </div>

  {{!-- Skills by Category --}}
  {{#each skillsByCategory as |categorySkills categoryKey|}}
  {{#if categorySkills.length}}
  <div class="skill-category" data-category="{{categoryKey}}">
    <h4 class="category-header">
      {{localize (concat "AOA.SkillCategory." (capitalize categoryKey))}}
      <span class="category-count">({{categorySkills.length}})</span>
    </h4>
    <ul class="skill-list">
      {{#each categorySkills}}
      {{!-- Show skill if: has rank > 0, OR showAllSkills is true --}}
      {{#if (or (gt rank 0) @root.showAllSkills)}}
      <li class="skill-item {{#if gated}}gated{{/if}} {{#unless rank}}unranked{{/unless}}" data-item-id="{{id}}">
        <span class="skill-name rollable {{#unless usable}}disabled{{/unless}}"
              data-action="rollSkill" data-skill="{{name}}"
              title="{{#if gated}}{{localize 'AOA.Warnings.SkillRequiresWitchsight'}}{{else}}{{localize 'AOA.Roll.ClickToRoll'}}{{/if}}">
          {{name}}
          {{#if requiresWitchsight}}
          <i class="fas fa-eye witchsight-indicator" title="{{localize 'AOA.Skill.RequiresWitchsight'}}"></i>
          {{/if}}
        </span>
        <span class="skill-attribute">{{localize (concat "AOA.Attribute." (capitalize attribute) ".abbr")}}</span>
        <span class="skill-rank">{{rank}}</span>
        <span class="skill-pool" title="{{localize 'AOA.Roll.Pool'}}">
          {{#with (lookup @root.attributeTotals attribute)}}
          ({{add this ../rank}}d6)
          {{/with}}
        </span>
        <div class="skill-controls">
          <a class="item-control" data-action="editItem" title="{{localize 'AOA.Common.Edit'}}">
            <i class="fas fa-edit"></i>
          </a>
          {{#if @root.isEditMode}}
          <a class="item-control" data-action="deleteItem" title="{{localize 'AOA.Common.Delete'}}">
            <i class="fas fa-trash"></i>
          </a>
          {{/if}}
        </div>
      </li>
      {{/if}}
      {{/each}}
    </ul>
  </div>
  {{/if}}
  {{/each}}

  {{!-- Add Skill Button --}}
  {{#if isEditMode}}
  <div class="item-create-row">
    <a class="item-create" data-action="createItem" data-type="skill">
      <i class="fas fa-plus"></i> {{localize "AOA.Item.AddSkill"}}
    </a>
  </div>
  {{/if}}
</section>
